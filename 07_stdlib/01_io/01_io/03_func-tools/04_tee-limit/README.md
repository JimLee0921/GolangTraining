## `io.LimitReader` / `io.TeeReader`

| 函数                         | 目的                   | 类比               |
|----------------------------|----------------------|------------------|
| **`io.LimitReader(r, n)`** | **只允许从 r 读取最多 n 字节** | 给水管装上限流阀         |
| **`io.TeeReader(r, w)`**   | 读取 r 的同时 **自动复制到 w** | 水流一边往前走，一边被旁路抄一份 |

### `io.LimitReader`

```
func LimitReader(r Reader, n int64) Reader
```

返回一个 新的 Reader，从中最多读取 n 字节，超过则表现为 EOF。不会修改 r 本身的行为，只是外层套了一层限制

| 场景           | 原因       |
|--------------|----------|
| 读取文件头信息      | 不想读取整个文件 |
| 网络协议中有“长度字段” | 按长度拆包    |
| 避免内存被大数据灌爆   | 安全限制     |

### `io.TeeReader`

```
func TeeReader(r Reader, w Writer) Reader
```

返回一个 Reader：

- 从中读取的数据还是来自 r
- 但每次读取到的数据会自动复制一份写入 w

| 用途      | 解释                 |
|---------|--------------------|
| 记录日志    | 读取数据的同时记录数据，不影响原流程 |
| 调试网络协议  | 看看实际读到了什么字节        |
| "边读边拷贝" | 不需要手动写两次           |
